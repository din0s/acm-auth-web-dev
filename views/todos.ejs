<%- include('partials/header'); -%>
<div class="container">
    <h1 id="title">TODOs</h1>
    <div class="row">
        <div class="col-md-6">
            <ul>
                <% todos.forEach((item, index) => { %>
                <%- include('components/task', {item, index}); -%>
                <% }) %>
            </ul>
        </div>
        <div class="col-md-6">
            <h2>Add New Task</h2>
            <form action="/todo" method="post">
                <div class="form-group">
                    <label for="title">Title:</label>
                    <input class="form-control" type="text" name="title" placeholder="Title"><br>
                </div>
                <div class="form-group">
                    <label for="description">Description:</label>
                    <input class="form-control" type="text" name="description" placeholder="Description"><br>
                </div>
                <div class="form-group">
                    <label for="priority">Priority:</label>
                    <input class="form-control" type="number" name="priority" placeholder="5"><br>
                </div>
                <input class="btn btn-primary" type="submit" value="Submit">
            </form>
        </div>
    </div>
</div>
<%- include('partials/footer'); -%>
<script>
$(function () {
    let forms = $('.delete-task-form')
    for (const form of forms) {
        $(form).submit((event) => {
            event.preventDefault()
            $.ajax('/todo', {
                method: 'DELETE',
                data: $(form).serialize()
            }).done((response) => {
                location.reload()
            }).error((error) => {
                console.error(error)
            })
            console.log('done')
        })
    }
})
</script>
<%- include('partials/endhtml'); -%>